webpackJsonp([22],{"53HV":function(t,e){},"FC/f":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("IHPB"),o=a.n(n),i=a("8RsO"),s={name:"message",data:function(){return{queryText:"",tableData:[],currentPage:1,pageSize:10,total:0,pageFlag:!1,loading:!1,tableEmptyText:" ",msgDialog:!1,formData:{title:"",content:""},formRules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]}}},mounted:function(){var t=this;this.$nextTick(function(){t._getMsg()})},methods:{_getMsg:function(){var t=this,e={page:this.currentPage,page_size:this.pageSize,content:this.queryText};this.loading=!0,Object(i.n)(e).then(function(e){0==e.data.ret?(t.currentPage=e.data.datas.cur_page,t.pageSize=e.data.datas.page_size,t.total=e.data.datas.item_counts,t.tableData=[].concat(o()(e.data.datas.list))):t.$message({message:e.data.msg,type:"error"}),t.pageFlag=!1,t.loading=!1,t.tableData.length||(t.tableEmptyText="暂无数据")})},onSizeChange:function(t){this.pageSize=t,this._getMsg()},onCurrentChange:function(t){this.pageFlag||(this.pageFlag=!0,this.currentPage=t,this._getMsg())},onSearchClick:function(t){this.queryText=t,1==this.currentPage?this._getMsg():this.currentPage=1},onAddClick:function(){this.msgDialog=!0},onCloseMsgDialog:function(){this.$refs.msgForm.resetFields()},onSubmitForm:function(){var t=this;this.$refs.msgForm.validate(function(e){if(!e)return t.$message({message:"请正确输入完成后再提交表单！",type:"error"}),!1;console.log(t.formData),Object(i.c)(t.formData).then(function(e){t.loadTableData(e,1)})})},onDeleteClick:function(t){var e=this;this.$confirm("此操作将永久删除该行, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i.i)({notice_id:t.system_notice_id}).then(function(t){e.loadTableData(t,2)})})},loadTableData:function(t,e){if(0==t.data.ret){this.msgDialog=!1,this._getMsg();var a=1===e?"添加成功！":"删除成功！";this.$message({message:a,type:"success"})}else this.$message({message:t.data.msg,type:"error"})}},components:{searchBox:a("Rv3D").a}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"message main-panel"},[a("searchBox",{attrs:{queryTip:"请输入标题",addBtn:!0},on:{onSearch:t.onSearchClick,onAdd:t.onAddClick}}),t._v(" "),a("el-dialog",{attrs:{title:"新增公告",visible:t.msgDialog,model:"right",width:"30%"},on:{"update:visible":function(e){t.msgDialog=e},close:t.onCloseMsgDialog}},[a("el-form",{ref:"msgForm",attrs:{model:t.formData,"label-width":"60px",rules:t.formRules}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{"auto-complete":"off",maxlength:20,placeholder:"请输入不多于20个文字的标题"},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"内容",prop:"content"}},[a("el-input",{attrs:{type:"textarea",maxlength:200,"auto-complete":"off",autosize:{minRows:8,maxRows:10},placeholder:"请输入不多于200个文字的内容"},model:{value:t.formData.content,callback:function(e){t.$set(t.formData,"content",e)},expression:"formData.content"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.msgDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmitForm}},[t._v("保 存")])],1)],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":"数据加载中..."}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"empty-text":t.tableEmptyText,border:"",height:"531"}},[a("el-table-column",{attrs:{prop:"title",width:"200",label:"标题"}}),t._v(" "),a("el-table-column",{attrs:{prop:"content",label:"内容"}}),t._v(" "),a("el-table-column",{attrs:{prop:"publish_time",width:"180",label:"发布时间"}}),t._v(" "),a("el-table-column",{attrs:{width:"80",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.onDeleteClick(e.row)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,20,30,40],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.onSizeChange,"current-change":t.onCurrentChange}})],1)},staticRenderFns:[]};var r=a("Z0/y")(s,l,!1,function(t){a("53HV")},"data-v-4411c0f4",null);e.default=r.exports}});
//# sourceMappingURL=22.607e7a983188d0328676.js.map