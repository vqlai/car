webpackJsonp([16],{"2WAS":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("aA9S"),o=a.n(r),i=a("IHPB"),n=a.n(i),l=a("8RsO"),s=a("3Ri9"),c={name:"charge",data:function(){return{tableData:[],currentPage:1,pageSize:10,total:0,pageFlag:!1,loading:!1,emptyText:" ",dialogType:1,chargeDialog:!1,queryText:"",formData:{id:"",name:"",type:1,price:"",remark:""},formRule:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],type:[{required:!0,message:"请输入类型",trigger:"change"}],price:[{required:!0,message:"请输入金额",trigger:"blur"},{validator:s.a.checkPrice,trigger:"blur"}],remark:[{required:!0,message:"请输入备注",trigger:"blur"}]},formOption:[{value:1,label:"按每公里里程收费"},{value:2,label:"按每升油耗收费"},{value:3,label:"按每日天数收费"}]}},mounted:function(){var e=this;this.$nextTick(function(){e._getCharge()})},methods:{_getCharge:function(){var e=this,t={page:this.currentPage,page_size:this.pageSize,scheme_name:this.queryText};this.loading=!0,Object(l.m)(t).then(function(t){e.pageFlag=!1,0==t.data.ret?(e.currentPage=t.data.datas.cur_page,e.pageSize=t.data.datas.page_size,e.total=t.data.datas.item_counts,e.tableData=[].concat(n()(t.data.datas.list))):e.$message({message:t.data.msg,type:"error"}),e.loading=!1,e.tableData.length||(e.emptyText="暂无数据")})},onEditClick:function(e){this.chargeDialog=!0,this.dialogType=2,this.formData.id=e.charge_scheme_id,this.formData.name=e.scheme_name,this.formData.type=e.type,this.formData.price=e.per_unit,this.formData.remark=e.mark},onDeleteClick:function(e){var t=this;this.$confirm("此操作将永久删除该行, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.h)({charge_scheme_id:e.charge_scheme_id}).then(function(e){t.loadTableData(e,3)})})},onSearchClick:function(e){this.queryText=e,1===this.currentPage?this._getCharge():this.currentPage=1},onAddChargeClick:function(){this.dialogType=1,this.chargeDialog=!0},onCloseChargeDialog:function(){this.$refs.chargeForm.resetFields(),this.formData.id="",this.formData.name="",this.formData.type=1,this.formData.price="",this.formData.remark=""},onSubmitForm:function(){var e=this;this.$refs.chargeForm.validate(function(t){if(!t)return console.log("error submit!!"),!1;var a={scheme_name:e.formData.name,type:e.formData.type,per_unit:e.formData.price,mark:e.formData.remark};1===e.dialogType?Object(l.b)(a).then(function(t){e.loadTableData(t,1)}):Object(l.t)(o()({charge_scheme_id:e.formData.id},a)).then(function(t){e.loadTableData(t,2)}),e.onCloseChargeDialog()})},loadTableData:function(e,t){if(0==e.data.ret){this.chargeDialog=!1,this._getCharge();var a=1===t?"添加成功！":2===t?"修改成功！":"删除成功！";this.$message({message:a,type:"success"})}else this.$message({message:e.data.msg,type:"error"})},onSizeChange:function(e){this.pageSize=e,this._getCharge()},onCurrentChange:function(e){this.pageFlag||(this.pageFlag=!0,this.currentPage=e,this._getCharge())},formatType:function(e,t,a){switch(a){case 1:return"按里程";case 2:return"按油耗";case 3:return"按天数";default:return"-"}},formatPrice:function(e,t,a){switch(e.type){case 1:return a+"元/公里";case 2:return a+"元/升";case 3:return a+"元/日";default:return"-"}}},components:{searchBox:a("Rv3D").a}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"charge main-panel"},[a("searchBox",{attrs:{queryTip:"请输入收费方案名称",addBtn:!0},on:{onSearch:e.onSearchClick,onAdd:e.onAddChargeClick}}),e._v(" "),a("el-dialog",{attrs:{title:1===e.dialogType?"新增收费方案":"编辑收费方案",visible:e.chargeDialog,model:"right",width:"30%"},on:{"update:visible":function(t){e.chargeDialog=t},close:e.onCloseChargeDialog}},[a("el-form",{ref:"chargeForm",attrs:{model:e.formData,"label-width":"100px",rules:e.formRule}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择收费类型"},model:{value:e.formData.type,callback:function(t){e.$set(e.formData,"type",t)},expression:"formData.type"}},e._l(e.formOption,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"金额",prop:"price"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formData.price,callback:function(t){e.$set(e.formData,"price",t)},expression:"formData.price"}}),e._v(" "),a("span",{domProps:{innerHTML:e._s(1==e.formData.type?"元/公里":2==e.formData.type?"元/升":"元/日")}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.chargeDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmitForm}},[e._v("保 存")])],1)],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"数据加载中..."}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":e.emptyText,border:"",height:"531"}},[a("el-table-column",{attrs:{prop:"scheme_name",label:"名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",width:"140",formatter:e.formatType,label:"类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"per_unit",width:"140",formatter:e.formatPrice,label:"金额"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mark",label:"备注"}}),e._v(" "),a("el-table-column",{attrs:{prop:"recent_time",width:"160",label:"更新时间"}}),e._v(" "),a("el-table-column",{attrs:{width:"100",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.onEditClick(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.onDeleteClick(t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.onSizeChange,"current-change":e.onCurrentChange}})],1)},staticRenderFns:[]};var u=a("Z0/y")(c,m,!1,function(e){a("Uo+n")},"data-v-64fe6e38",null);t.default=u.exports},"Uo+n":function(e,t){}});
//# sourceMappingURL=16.c319b0cbf4f05fb55e09.js.map