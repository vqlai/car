webpackJsonp([6],{"1AQX":function(t,e){},"3cXf":function(t,e,a){t.exports={default:a("4rP4"),__esModule:!0}},"4rP4":function(t,e,a){var o=a("UusJ"),l=o.JSON||(o.JSON={stringify:JSON.stringify});t.exports=function(t){return l.stringify.apply(l,arguments)}},ZXHx:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("3cXf"),l=a.n(o),c=a("egIO"),i=a("simw"),n={name:"control",data:function(){return{carData:{carNumber:null,doorState:!1,winState:!1,voiceState:!1,left_f_lock:!1,right_f_lock:!1,left_b_lock:!1,right_b_lock:!1},btns:[{label:"解锁",type:1},{label:"落锁",type:2},{label:"降窗",type:3},{label:"升窗",type:4},{label:"寻车",type:7}],loadingText:"",stompClient:null,loading:!1,showLockState:!1,showVoiceState:!1}},mounted:function(){setTimeout(function(){},20)},methods:{onBtnClick:function(t){return this.carData.carNumber?this.carData.doorState&&2===t.type?(this.$alert("请关好车门！","提示",{confirmButtonText:"确定"}),!1):void this.onSendMsg(t):(this.$message({message:"请选择在线车辆进行远程控制",type:"error"}),!1)},onSendMsg:function(t){var e=this,a=window.sessionStorage.getItem("userid");if(this.loadingText=t.label+"中...",this.loading=!0,t.type>4&&(this.showVoiceState=!0),!this.stompClient||!this.stompClient.connected){var o=new SockJS("//iotsvr.he-live.com:8002/my-websocket");this.stompClient=Stomp.over(o),this.stompClient.connect({},function(o){e.stompClient.subscribe("/topic/web/"+a+"/remote_ctl_notify",function(a){var o=JSON.parse(a.body);e.stompClient.disconnect(),0==o.ret?(1!=t.type&&2!=t.type||Object(i.e)({vehicle_number:e.carData.carNumber}).then(function(t){var a=t.data,o=a.ret,l=(a.msg,a.datas);0==o&&(e.carData.left_f_lock=1==l.left_f_lock,e.carData.right_f_lock=1==l.right_f_lock,e.carData.left_b_lock=1==l.left_b_lock,e.carData.right_b_lock=1==l.right_b_lock)}),e.$alert(t.label+"成功","提示",{confirmButtonText:"确定"}),e.loading=!1):(e.$alert(o.msg,"提示",{confirmButtonText:"确定"}),e.loading=!1),t.type>4&&(e.showVoiceState=!1)}),e.stompClient.send("/web/remote_control",{},l()({vehicle_number:e.carData.carNumber,cmd_type:t.type,user_id:a}))})}},onCarTableCellClick:function(t,e,a,o){var l=this;t.is_online?(this.showLockState=!1,Object(i.e)({vehicle_number:t.vehicle_number}).then(function(t){var e=t.data,a=e.ret,o=(e.msg,e.datas);0==a&&(l.carData.carNumber=o.vehicle_number,l.carData.doorState=1==o.door_state,l.carData.winState=1==o.windows_state,l.carData.left_f_lock=1==o.left_f_lock,l.carData.right_f_lock=1==o.right_f_lock,l.carData.left_b_lock=1==o.left_b_lock,l.carData.right_b_lock=1==o.right_b_lock,l.carData.voiceState=!1,l.showLockState=!0)})):this.$message({message:"请选择在线的车辆进行远程控制",type:"error"})}},components:{carTable:c.a}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"control"},[a("el-container",[a("el-main",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":t.loadingText,"element-loading-background":"rgba(255, 255, 255, 0.7)"}},[a("div",{staticClass:"car-box"},[a("div",{staticClass:"car"},[t.showLockState?a("div",{staticClass:"lock-top clearfix"},[a("div",{class:["left",{on:t.carData.left_f_lock}]}),t._v(" "),a("div",{class:["right",{on:t.carData.right_f_lock}]})]):t._e(),t._v(" "),t.showLockState?a("div",{staticClass:"lock-bottom clearfix"},[a("div",{class:["left",{on:t.carData.left_b_lock}]}),t._v(" "),a("div",{class:["right",{on:t.carData.right_b_lock}]})]):t._e(),t._v(" "),t.showVoiceState?a("div",{class:["center","on"]}):t._e()])]),t._v(" "),a("ul",t._l(t.btns,function(e){return a("li",{on:{click:function(a){t.onBtnClick(e)}}},[t._v(t._s(e.label))])}))]),t._v(" "),a("el-aside",{attrs:{width:"320px"}},[a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"车辆列表"}},[a("carTable",{on:{onCarTableCellClick:t.onCarTableCellClick}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var s=a("Z0/y")(n,r,!1,function(t){a("1AQX")},"data-v-6254b49a",null);e.default=s.exports}});
//# sourceMappingURL=6.a04053713ea7347c1c2b.js.map