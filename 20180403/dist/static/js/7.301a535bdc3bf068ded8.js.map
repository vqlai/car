{"version":3,"sources":["webpack:///./node_modules/_babel-runtime@6.26.0@babel-runtime/core-js/json/stringify.js","webpack:///./node_modules/_core-js@2.5.3@core-js/library/fn/json/stringify.js","webpack:///src/pages/operation/state/state.vue","webpack:///./src/pages/operation/state/state.vue?4873","webpack:///./src/pages/operation/state/state.vue"],"names":["module","exports","default","__webpack_require__","__esModule","core","$JSON","JSON","stringify","it","apply","arguments","state","onSendMsg","_this","this","socket","msg","body","battery_voltage","engine_speed","water_tem","lat","location","pos_update_time","then","carNumber","userid","row","vehicle_number","carTable","state_state","render","_vm","_h","$createElement","_c","_self","staticClass","directives","name","rawName","value","expression","attrs","element-loading-text","loadingText","element-loading-background","_v","_s","carText","placeholder","readonly","model","callback","$$v","voltage","speed","temp","lnglat","doorState","winState","monitorTime","type","on","click","onReload","width","label","onCarTableCellClick","staticRenderFns","Component","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/7.301a535bdc3bf068ded8.js","sourcesContent":["module.exports = { \"default\": require(\"core-js/library/fn/json/stringify\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_babel-runtime@6.26.0@babel-runtime/core-js/json/stringify.js\n// module id = 3cXf\n// module chunks = 6 7","var core = require('../../modules/_core');\nvar $JSON = core.JSON || (core.JSON = { stringify: JSON.stringify });\nmodule.exports = function stringify(it) { // eslint-disable-line no-unused-vars\n  return $JSON.stringify.apply($JSON, arguments);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_core-js@2.5.3@core-js/library/fn/json/stringify.js\n// module id = 4rP4\n// module chunks = 6 7","<style scoped lang=\"less\">\r\n  @import \"./state.less\";\r\n</style>\r\n\r\n<template>\r\n  <section class=\"state\">\r\n    <el-container>\r\n      <el-main v-loading=\"loading\" :element-loading-text=\"loadingText\" element-loading-background=\"rgba(255, 255, 255, 0.4)\">\r\n        <div class=\"info-box\">\r\n          <p class=\"car-text\">{{carText}}</p>\r\n          <ul>\r\n            <li><span>电瓶电压：</span><el-input v-model=\"voltage\" placeholder=\"电瓶电压\" readonly></el-input></li>\r\n            <li><span>发动机转速：</span><el-input v-model=\"speed\" placeholder=\"发动机转速\" readonly></el-input></li>\r\n            <li><span>冷却液温度：</span><el-input v-model=\"temp\" placeholder=\"水温\" readonly></el-input></li>\r\n            <li><span>经纬度：</span><el-input v-model=\"lnglat\" placeholder=\"经纬度\" readonly></el-input></li>\r\n            <li><span>实时位置：</span><el-input v-model=\"location\" placeholder=\"实时位置\" readonly></el-input></li>\r\n            <li><span>车门状态：</span><el-input v-model=\"doorState\" placeholder=\"车门状态\" readonly></el-input></li>\r\n            <li><span>车窗状态：</span><el-input v-model=\"winState\" placeholder=\"车窗状态\" readonly></el-input></li>\r\n            <li><span>监测时间：</span><el-input v-model=\"monitorTime\" placeholder=\"监测时间\" readonly></el-input></li>\r\n          </ul>\r\n          <div class=\"btn-box\">\r\n            <el-button type=\"primary\" @click=\"onReload\">刷新</el-button>\r\n          </div>\r\n        </div>\r\n      </el-main>\r\n      <el-aside width=\"320px\">\r\n        <el-tabs type=\"border-card\">\r\n          <el-tab-pane label=\"车辆列表\">\r\n            <carTable @onCarTableCellClick=\"onCarTableCellClick\"></carTable>\r\n          </el-tab-pane>\r\n        </el-tabs>\r\n      </el-aside>\r\n    </el-container>\r\n  </section>\r\n</template>\r\n\r\n<script>\r\nimport carTable from '@/components/car-table'\r\nexport default {\r\n  name: 'state',\r\n  data () {\r\n    return {\r\n    \tcarText: '请在表格选择需要监测的车牌号',\r\n      carNumber: '',\r\n      voltage: '',\r\n      speed: '',\r\n      temp: '',\r\n      lnglat: '',\r\n      location: '',\r\n      doorState: '',\r\n      winState: '',\r\n      monitorTime: '',\r\n      stompClient: null,\r\n      loading: false,\r\n      loadingText: '正在获取最新数据，请稍后...'\r\n    }\r\n  },\r\n  mounted() {\r\n    setTimeout(()=>{\r\n    },20)\r\n  },\r\n  methods:{\r\n    onReload(){\r\n      if(this.carNumber){\r\n        this.onSendMsg()\r\n      }else{\r\n        this.$message({\r\n          message: '请选择在线的设备进行远程控制',\r\n          type: 'error'\r\n        })\r\n      }\r\n    },\r\n    onSendMsg(){\r\n      if(!this.stompClient || !this.stompClient.connected){\r\n        // 建立socket连接并且订阅消息\r\n        let socket = new SockJS(`${process.env.BASE_API}/my-websocket`)\r\n        let userid = window.sessionStorage.getItem('userid')\r\n        this.stompClient = Stomp.over(socket)\r\n        this.stompClient.connect({}, (frame) => {\r\n          // console.log(frame)\r\n          // subscribe订阅消息，接收后台消息\r\n          this.stompClient.subscribe(`/topic/web/${userid}/vehicle_manager_info`, (msg) => {\r\n            console.log(msg)\r\n            this.stompClient.disconnect() // 关闭socket连接\r\n            let res = JSON.parse(msg.body)\r\n            if(res.ret == 0){\r\n              this.voltage = res.datas.battery_voltage\r\n              this.speed = res.datas.engine_speed\r\n              this.temp = res.datas.water_tem\r\n              this.lnglat = `${res.datas.lng}，${res.datas.lat}`\r\n              this.location = res.datas.location\r\n              this.monitorTime = res.datas.pos_update_time\r\n              this.doorState = res.datas.door_state == 1 ? '车门已打开': '车门已关闭'\r\n              this.winState = res.datas.wind_state == 1 ? '车窗已打开': '车窗已关闭'\r\n              this.loading = false\r\n            }else{\r\n              this.$confirm('获取最新车况失败，再试一次?', '提示', {\r\n                confirmButtonText: '确定',\r\n                cancelButtonText: '取消',\r\n                type: 'warning'\r\n              }).then(() => {\r\n                this.onSendMsg()\r\n              })\r\n              this.loading = false\r\n            }\r\n          })\r\n          // send发送消息，发送前端消息\r\n          this.stompClient.send(\"/web/vehicle_state\", {}, JSON.stringify({\r\n            'vehicle_number' : this.carNumber,\r\n            'user_id': userid\r\n          }))\r\n        })\r\n      }\r\n      \r\n      this.loading = true\r\n    },\r\n    // 表格车牌号单元格点击事件\r\n    onCarTableCellClick(row, column, cell, event){\r\n      console.log(row)\r\n      if(row.is_online){\r\n        this.carNumber = row.vehicle_number\r\n        this.carText = `当前车牌号：${row.vehicle_number}`\r\n        this.onSendMsg()\r\n      }else{\r\n        this.$message({\r\n          message: '请选择在线的设备进行远程控制',\r\n          type: 'error'\r\n        })\r\n      }\r\n    },\r\n  },\r\n  components:{\r\n    carTable\r\n  }\r\n}\r\n</script>\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/operation/state/state.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticClass:\"state\"},[_c('el-container',[_c('el-main',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],attrs:{\"element-loading-text\":_vm.loadingText,\"element-loading-background\":\"rgba(255, 255, 255, 0.4)\"}},[_c('div',{staticClass:\"info-box\"},[_c('p',{staticClass:\"car-text\"},[_vm._v(_vm._s(_vm.carText))]),_vm._v(\" \"),_c('ul',[_c('li',[_c('span',[_vm._v(\"电瓶电压：\")]),_c('el-input',{attrs:{\"placeholder\":\"电瓶电压\",\"readonly\":\"\"},model:{value:(_vm.voltage),callback:function ($$v) {_vm.voltage=$$v},expression:\"voltage\"}})],1),_vm._v(\" \"),_c('li',[_c('span',[_vm._v(\"发动机转速：\")]),_c('el-input',{attrs:{\"placeholder\":\"发动机转速\",\"readonly\":\"\"},model:{value:(_vm.speed),callback:function ($$v) {_vm.speed=$$v},expression:\"speed\"}})],1),_vm._v(\" \"),_c('li',[_c('span',[_vm._v(\"冷却液温度：\")]),_c('el-input',{attrs:{\"placeholder\":\"水温\",\"readonly\":\"\"},model:{value:(_vm.temp),callback:function ($$v) {_vm.temp=$$v},expression:\"temp\"}})],1),_vm._v(\" \"),_c('li',[_c('span',[_vm._v(\"经纬度：\")]),_c('el-input',{attrs:{\"placeholder\":\"经纬度\",\"readonly\":\"\"},model:{value:(_vm.lnglat),callback:function ($$v) {_vm.lnglat=$$v},expression:\"lnglat\"}})],1),_vm._v(\" \"),_c('li',[_c('span',[_vm._v(\"实时位置：\")]),_c('el-input',{attrs:{\"placeholder\":\"实时位置\",\"readonly\":\"\"},model:{value:(_vm.location),callback:function ($$v) {_vm.location=$$v},expression:\"location\"}})],1),_vm._v(\" \"),_c('li',[_c('span',[_vm._v(\"车门状态：\")]),_c('el-input',{attrs:{\"placeholder\":\"车门状态\",\"readonly\":\"\"},model:{value:(_vm.doorState),callback:function ($$v) {_vm.doorState=$$v},expression:\"doorState\"}})],1),_vm._v(\" \"),_c('li',[_c('span',[_vm._v(\"车窗状态：\")]),_c('el-input',{attrs:{\"placeholder\":\"车窗状态\",\"readonly\":\"\"},model:{value:(_vm.winState),callback:function ($$v) {_vm.winState=$$v},expression:\"winState\"}})],1),_vm._v(\" \"),_c('li',[_c('span',[_vm._v(\"监测时间：\")]),_c('el-input',{attrs:{\"placeholder\":\"监测时间\",\"readonly\":\"\"},model:{value:(_vm.monitorTime),callback:function ($$v) {_vm.monitorTime=$$v},expression:\"monitorTime\"}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"btn-box\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onReload}},[_vm._v(\"刷新\")])],1)])]),_vm._v(\" \"),_c('el-aside',{attrs:{\"width\":\"320px\"}},[_c('el-tabs',{attrs:{\"type\":\"border-card\"}},[_c('el-tab-pane',{attrs:{\"label\":\"车辆列表\"}},[_c('carTable',{on:{\"onCarTableCellClick\":_vm.onCarTableCellClick}})],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.1@vue-loader/lib/template-compiler?{\"id\":\"data-v-165b042e\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.1@vue-loader/lib/selector.js?type=template&index=0!./src/pages/operation/state/state.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@13.7.1@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-165b042e\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@13.7.1@vue-loader/lib/selector?type=styles&index=0!./state.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/_vue-loader@13.7.1@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/_vue-loader@13.7.1@vue-loader/lib/selector?type=script&index=0!./state.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/_vue-loader@13.7.1@vue-loader/lib/selector?type=script&index=0!./state.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/_vue-loader@13.7.1@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-165b042e\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/_vue-loader@13.7.1@vue-loader/lib/selector?type=template&index=0!./state.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-165b042e\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/operation/state/state.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}